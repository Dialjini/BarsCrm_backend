function linkField(){$(".field").click(function(){function a(a){for(let b=1;b<a.length;b++)a[b].objectName[0].active=!1}sortStatus={product:{status:!1,filter:null,last:null},price:{status:!1,filter:null},area:{status:!1,filter:null},category:{status:!1,filter:null,last:null},manager:{status:!1,filter:null,last:null}},$(".table").remove(),$(".field").removeClass("active"),$(`#${this.id}`).addClass("active"),$("div").is("#card_menu, #contract-decor, #invoicing, .invoicing")?$(".card_menu").remove():"";for(let b=0;b<subcategoryButtons.length;b++)for(let c=1;c<subcategoryButtons[b].length;c++)if(this.id==subcategoryButtons[b][c].id){a(subcategoryButtons[b]),getTableData(subcategoryButtons[b][c].objectName);break}}),$(".list").click(function(){let a;$.ajax({url:"/getThisUser",type:"GET",async:!1,dataType:"html",success:function(b){a=JSON.parse(b)}});const b=[{width:161.125,id:"stock_group",list:[]},{width:90.656,id:"stock_product",list:[]},{width:110.328,id:"stock_packing",list:[]},{width:92.297,id:"stock_stock",list:[]},{width:97.281,id:"stock_volume",list:[]},{width:220,id:"analytics_reports",list:"admin"==a.role?["\u041F\u0440\u0438\u0431\u044B\u043B\u044C \u043F\u043E \u043A\u043B\u0438\u0435\u043D\u0442\u0430\u043C","\u0421\u0432\u043E\u0434\u043D\u044B\u0439 \u043F\u043E \u043E\u0431\u044A\u0451\u043C\u0430\u043C","\u041F\u043E \u043A\u043B\u0438\u0435\u043D\u0442\u0430\u043C","\u041F\u043E \u043F\u0440\u0438\u0432\u0435\u0442\u0430\u043C","\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0438 \u043C\u0435\u043D\u0435\u0434\u0436\u0435\u0440\u043E\u0432"]:["\u0421\u0432\u043E\u0434\u043D\u044B\u0439 \u043F\u043E \u043E\u0431\u044A\u0451\u043C\u0430\u043C","\u041F\u043E \u043A\u043B\u0438\u0435\u043D\u0442\u0430\u043C","\u041F\u043E \u043F\u0440\u0438\u0432\u0435\u0442\u0430\u043C","\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0438 \u043C\u0435\u043D\u0435\u0434\u0436\u0435\u0440\u043E\u0432"]},{width:150,id:"analytics_period",list:["\u0417\u0430 \u0432\u0441\u0451 \u0432\u0440\u0435\u043C\u044F","\u0417\u0430 \u0434\u0435\u043D\u044C","\u0417\u0430 \u043D\u0435\u0434\u0435\u043B\u044E","\u0417\u0430 \u043C\u0435\u0441\u044F\u0446","\u0417\u0430 \u0433\u043E\u0434"]}];let c,d=this.id,e=["Group_name","Name","Packing","stock_address"];if(!d.includes("analytics"))for(let a=0;a<e.length;a++)for(let c=0;c<categoryInStock[1][1].length;c++)for(let d=0;d<categoryInStock[1][1][c].items.length;d++)3===a?b[a].list.push(categoryInStock[1][1][c][e[a]]):b[a].list.push(categoryInStock[1][1][c].items[d][e[a]]);for(let a=0;a<b.length;a++)b[a].id===d&&(c=a);let f=b[c].list;for(let a=0;a<f.length-1;a++)for(let b=a+1;b<f.length;b++)f[a].toLowerCase()===f[b].toLowerCase()&&(f.splice(b,1),b--);if($(`#${d} .drop_down_img`).hasClass("drop_active"))return $(`#${d} .drop_down_img`).removeClass("drop_active"),$(`#${d} .report_list`).fadeOut(200),void setTimeout(()=>{$(`#${d} .report_list`).remove()},300);for(let a=0;a<b.length;a++)$(`#${b[a].id}`).width("auto");let g;$(".report_list").remove(),$(".drop_down_img").removeClass("drop_active"),$(".field_with_modal").removeClass("active"),$(this).append($("<div>",{class:"report_list",id:d})),$(".report_list").append(function(){for(let a=0;a<b.length;a++)if(b[a].id==d){g=b[a].list;let c=$("<ul>");for(let e=0;e<b[a].list.length;e++)c.append(`<li id="${d}_${e}">${b[a].list[e]}</li>`);return c}}()),function(){let a=$(`#${d} .report_list`).width();for(let c=0;c<b.length;c++)if(b[c].id==d)if(a>b[c].width){$(`#${d}`).width(a);for(let b=0;b<$(`#${d} .report_list`).children()[0].children.length;b++)$(`#${d} .report_list`).children()[0].children[b].style.width=a+"px"}else{$(`#${d}`).width(b[c].width),$(`#${d} .report_list`).width(b[c].width);for(let a=0;a<$(`#${d} .report_list`).children()[0].children.length;a++)$(`#${d} .report_list`).children()[0].children[a].style.width=b[c].width+"px"}}(),$(".report_list").fadeIn(400),$(`#${d} .field_with_modal`).addClass("active"),$(`#${d} .drop_down_img`).addClass("drop_active"),$("li").click(function(){let b=this.innerHTML;$("table").remove(),$(`#${d} #active_field`).html(g[this.id.split("_")[2]]),$(`#${d} .field_with_modal`).addClass("active");let c=()=>{if(d.includes("analytics_reports")){return $("#analytics_period .field_with_modal")[0].children[0].innerHTML="\u041F\u0435\u0440\u0438\u043E\u0434",[analyticsFilterTable_0,analyticsFilterTable_1,analyticsFilterTable_2,analyticsFilterTable_3,analyticsFilterTable_4][this.id.split("_")[2]]()}if(d.includes("analytics_period")){let b=[analyticsFilterTable_0,analyticsFilterTable_1,analyticsFilterTable_2,analyticsFilterTable_3,analyticsFilterTable_4],c="admin"==a.role?["\u041F\u0440\u0438\u0431\u044B\u043B\u044C \u043F\u043E \u043A\u043B\u0438\u0435\u043D\u0442\u0430\u043C","\u0421\u0432\u043E\u0434\u043D\u044B\u0439 \u043F\u043E \u043E\u0431\u044A\u0451\u043C\u0430\u043C","\u041F\u043E \u043A\u043B\u0438\u0435\u043D\u0442\u0430\u043C","\u041F\u043E \u043F\u0440\u0438\u0432\u0435\u0442\u0430\u043C","\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0438 \u043C\u0435\u043D\u0435\u0434\u0436\u0435\u0440\u043E\u0432"]:["\u0421\u0432\u043E\u0434\u043D\u044B\u0439 \u043F\u043E \u043E\u0431\u044A\u0451\u043C\u0430\u043C","\u041F\u043E \u043A\u043B\u0438\u0435\u043D\u0442\u0430\u043C","\u041F\u043E \u043F\u0440\u0438\u0432\u0435\u0442\u0430\u043C","\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0438 \u043C\u0435\u043D\u0435\u0434\u0436\u0435\u0440\u043E\u0432"];for(let a=0;a<c.length;a++)if($("#analytics_reports").children()[0].children[0].innerHTML==c[a])return b[a](this.id.split("_")[2])}else{$(".centerBlock .header .cancel").remove(),$(".centerBlock .header").append(`
                        <div class="cancel">
                            <button class="btn btn-main" onclick="cancelSearch()">Отменить поиск</button>
                        </div>
                    `);let a=[{id:"stock_group",filterName:"Group_name",name:"\u0413\u0440\u0443\u043F\u043F\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432"},{id:"stock_product",filterName:"Name",name:"\u0422\u043E\u0432\u0430\u0440"},{id:"stock_packing",filterName:"Packing",name:"\u0424\u0430\u0441\u043E\u0432\u043A\u0430"},{id:"stock_volume",filterName:"Volume",name:"\u041E\u0431\u044A\u0435\u043C"},{id:"stock_stock",filterName:"stock_address",name:"\u0421\u043A\u043B\u0430\u0434"}];if(lastData.last_id==d){if("filter_stock"==lastData.last_table[0].id){let c=lastData.last_table;lastData.last_table=[{id:"filter_stock",name:"\u0421\u043A\u043B\u0430\u0434",active:!0,lastCard:[null,null]},[[{name:"\u0413\u0440\u0443\u043F\u043F\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",width:15},{name:"\u0422\u043E\u0432\u0430\u0440",width:15},{name:"\u042E\u0440. \u043B\u0438\u0446\u043E",width:5},{name:"\u0412\u0435\u0441",width:5},{name:"\u041E\u0431\u044A\u0435\u043C",width:5},{name:"\u0424\u0430\u0441\u043E\u0432\u043A\u0430",width:15},{name:"\u041D\u0414\u0421",width:5},{name:"\u0426\u0435\u043D\u0430 \u043F\u0440\u0430\u0439\u0441\u0430",width:5},{name:"\u0421\u043A\u043B\u0430\u0434",width:15}]]],lastData.last_table[1][1]=c[1][1];let e=[];for(let f=0;f<c[1][1].length;f++)for(let g=0;g<a.length;g++)a[g].id==d&&c[1][1][f][a[g].filterName]==b&&(c[1][1][f].stock_address=c[1][1][f].stock_address,e.push(c[1][1][f]));c[1][1]=[];for(let a=0;a<e.length;a++)c[1][1].push(e[a]);return lastData.last_id=d,fillingTables(c)}if("stock"==lastData.last_table[0].id){let c=lastData.last_table;lastData.last_table=[{id:"stock",name:"\u0421\u043A\u043B\u0430\u0434",active:!0,lastCard:[null,null]},[[{name:"\u042E\u0440. \u043B\u0438\u0446\u043E",width:5},{name:"\u0413\u0440\u0443\u043F\u043F\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",width:15},{name:"\u0422\u043E\u0432\u0430\u0440",width:15},{name:"\u0412\u0435\u0441",width:5},{name:"\u0424\u0430\u0441\u043E\u0432\u043A\u0430",width:15},{name:"\u041E\u0431\u044A\u0435\u043C",width:5},{name:"\u0426\u0435\u043D\u0430 \u043F\u0440\u0430\u0439\u0441\u0430",width:5},{name:"\u041D\u0414\u0421",width:5},{name:"\u0421\u043A\u043B\u0430\u0434",width:15}]]],lastData.last_table[1][1]=c[1][1];let e=[];for(let f=0;f<c[1][1].length;f++)for(let g=0;g<c[1][1][f].items.length;g++)for(let h=0;h<a.length;h++)"stock_stock"==d?c[1][1][f][a[h].filterName]==b&&(c[1][1][f].items[g].stock_address=c[1][1][f].stock_address,e.push(c[1][1][f].items[g])):a[h].id==d&&c[1][1][f].items[g][a[h].filterName]==b&&(c[1][1][f].items[g].stock_address=c[1][1][f].stock_address,e.push(c[1][1][f].items[g]));c[1][1]=[];for(let a=0;a<e.length;a++)c[1][1].push(e[a]);return c[0].id="filter_stock",lastData.last_id=d,fillingTables(c)}}else if(0==categoryInFilterStock[1][1].length){let c=categoryInStock[1][1],e=[];lastData.last_table=[{id:"stock",name:"\u0421\u043A\u043B\u0430\u0434",active:!0,lastCard:[null,null]},[[{name:"\u042E\u0440. \u043B\u0438\u0446\u043E",width:5},{name:"\u0413\u0440\u0443\u043F\u043F\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",width:15},{name:"\u0422\u043E\u0432\u0430\u0440",width:15},{name:"\u0412\u0435\u0441",width:5},{name:"\u0424\u0430\u0441\u043E\u0432\u043A\u0430",width:15},{name:"\u041E\u0431\u044A\u0435\u043C",width:5},{name:"\u0426\u0435\u043D\u0430 \u043F\u0440\u0430\u0439\u0441\u0430",width:5},{name:"\u041D\u0414\u0421",width:5},{name:"\u0421\u043A\u043B\u0430\u0434",width:15}]]],lastData.last_table[1][1]=categoryInStock[1][1];for(let f=0;f<c.length;f++)for(let g=0;g<c[f].items.length;g++)for(let h=0;h<a.length;h++)"stock_stock"==d?c[f][a[h].filterName]==b&&(c[f].items[g].stock_address=c[f].stock_address,e.push(c[f].items[g])):a[h].id==d&&c[f].items[g][a[h].filterName]==b&&(c[f].items[g].stock_address=c[f].stock_address,e.push(c[f].items[g]));c=[];for(let a=0;a<e.length;a++)c.push(e[a]);return lastData.last_id=d,categoryInFilterStock[1][1]=c,c=[{id:"filter_stock",name:"\u0421\u043A\u043B\u0430\u0434",active:!0,lastCard:[null,null]},[[{name:"\u042E\u0440. \u043B\u0438\u0446\u043E",width:5},{name:"\u0413\u0440\u0443\u043F\u043F\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",width:15},{name:"\u0422\u043E\u0432\u0430\u0440",width:15},{name:"\u0412\u0435\u0441",width:5},{name:"\u0424\u0430\u0441\u043E\u0432\u043A\u0430",width:15},{name:"\u041E\u0431\u044A\u0435\u043C",width:5},{name:"\u0426\u0435\u043D\u0430 \u043F\u0440\u0430\u0439\u0441\u0430",width:5},{name:"\u041D\u0414\u0421",width:5},{name:"\u0421\u043A\u043B\u0430\u0434",width:15}],c]],fillingTables(c)}else{let c=categoryInFilterStock;lastData.last_table=[{id:"filter_stock",name:"\u0421\u043A\u043B\u0430\u0434",active:!0,lastCard:[null,null]},[[{name:"\u042E\u0440. \u043B\u0438\u0446\u043E",width:5},{name:"\u0413\u0440\u0443\u043F\u043F\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",width:15},{name:"\u0422\u043E\u0432\u0430\u0440",width:15},{name:"\u0412\u0435\u0441",width:5},{name:"\u0424\u0430\u0441\u043E\u0432\u043A\u0430",width:15},{name:"\u041E\u0431\u044A\u0435\u043C",width:5},{name:"\u0426\u0435\u043D\u0430 \u043F\u0440\u0430\u0439\u0441\u0430",width:5},{name:"\u041D\u0414\u0421",width:5},{name:"\u0421\u043A\u043B\u0430\u0434",width:15}]]],lastData.last_table[1][1]=categoryInFilterStock[1][1];let e=[];for(let f=0;f<c[1][1].length;f++)for(let g=0;g<a.length;g++)a[g].id==d&&c[1][1][f][a[g].filterName]==b&&(c[1][1][f].stock_address=c[1][1][f].stock_address,e.push(c[1][1][f]));c[1][1]=[];for(let a=0;a<e.length;a++)c[1][1].push(e[a]);return lastData.last_id=d,fillingTables(c)}}};$(".info").append(c()),("\u0421\u0432\u043E\u0434\u043D\u044B\u0439 \u043F\u043E \u043E\u0431\u044A\u0451\u043C\u0430\u043C"==$("#active_field").html()||"\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0438 \u043C\u0435\u043D\u0435\u0434\u0436\u0435\u0440\u043E\u0432"==$("#active_field").html())&&$(".table").width("fit-content")})})}let lastData={last_id:"",last_table:""};function linkCategory(a){$(".info").empty(),$("[name=\"linkCategory\"], .mini_logo").removeClass("active"),$(`#${a}`).addClass("active"),lastData={last_id:"",last_table:""},sortStatus={product:{status:!1,filter:null,last:null},price:{status:!1,filter:null},area:{status:!1,filter:null},category:{status:!1,filter:null,last:null},manager:{status:!1,filter:null,last:null}},categoryInFilterStock[1][1]=[];for(let b=0;b<linkCategoryInfo.length;b++)if(a==linkCategoryInfo[b].id)for(let a=0;a<linkCategoryInfo[b].subcategories.length;a++)if(linkCategoryInfo[b].subcategories[a][0].active){addButtonsSubcategory(b),getTableData(linkCategoryInfo[b].subcategories[a]),1>=b?$(`#${linkCategoryInfo[b].subcategories[a][0].id}Button`).addClass("active"):"";break}linkField()}function addButtonsSubcategory(a){$(".info").append($("<div>",{class:"row",id:"subcategories",append:$("<div>",{class:"fields"}).add($("<div>",{class:"category",html:subcategoryButtons[a][0].toUpperCase()}))}));for(let b=1;b<subcategoryButtons[a].length;b++){let c;$(".fields").append(()=>"\u0421\u043A\u043B\u0430\u0434"===subcategoryButtons[a][0]||"\u0410\u043D\u0430\u043B\u0438\u0442\u0438\u043A\u0430"===subcategoryButtons[a][0]?$("<div>",{class:"list",id:subcategoryButtons[a][b].id,append:$("<div>",{class:subcategoryButtons[a][b].class,append:$("<span>",{html:subcategoryButtons[a][b].name,id:"active_field"}).add($("<img>",{src:"static/images/dropmenu_black.svg",class:"drop_down_img"}))})}):c=$("<div>",{class:subcategoryButtons[a][b].class,html:subcategoryButtons[a][b].name,id:subcategoryButtons[a][b].id})),$("#delivery_new").attr("onclick","reloadStockItems(this)")}}function closePersonCard(){$(".card_menu").remove(),adminPanel()}function userInfo(a){function b(a){return"admin"==a?`
                <option selected value="admin">Администратор</option>
                <option value="manager">Менеджер</option>
            `:`
                <option value="admin">Администратор</option>
                <option selected value="manager">Менеджер</option>
            `}$.ajax({url:"/getUsers",type:"GET",dataType:"html",success:function(c){c=JSON.parse(c);for(let d=0;d<c.length;d++)c[d].id==a.id&&($(".table, .card_menu").remove(),$(".info").append(`
                        <div class="card_menu persons" id="card_menu">
                            <div class="title">
                                <div class="left_side">
                                    <span>Редактирование сотрудника</span>
                                </div>
                                <div class="right_side">
                                    <div class="close" onclick="closePersonCard()">
                                        <img src="static/images/cancel.png">
                                    </div>
                                </div>
                            </div>
                            <div class="content">
                                <div class="row_card">
                                    <table class="table_block">
                                        <tr>
                                            <td>Фамилия</td>
                                            <td>
                                                <input type="text" value="${c[d].second_name}" disabled>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Имя</td>
                                            <td>
                                                <input type="name" value="${c[d].name}" disabled>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Отчество</td>
                                            <td>
                                                <input type="text" value="${c[d].third_name}" id="edit_patronymic">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Должность</td>
                                            <td>
                                                <select type="text" id="edit_role">
                                                    ${b(c[d].role)}
                                                </select>
                                            </td>
                                        </tr>
                                    </table>
                                    <table class="table_block">
                                        <tr>
                                            <td>Email</td>
                                            <td>
                                                <input type="email" value="${c[d].email}" id="edit_email">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Логин</td>
                                            <td>
                                                <input type="login" value="${c[d].login}" disabled>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Пароль</td>
                                            <td>
                                                <input type="text" value="${c[d].password}" id="edit_password">
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div class="next">
                                    <button class="btn btn-main" id="${c[d].id}" onclick="deleteMember(this.id)">Удалить</button>
                                    <button class="btn btn-main" id="${c[d].id}" onclick="editMember(this.id)">Изменить</button>
                                </div>
                            </div>
                        </div>`))}})}function deleteMember(a){$.ajax({url:"/deleteMember",type:"GET",data:{id:a},dataType:"html",success:function(){$(".card_menu").remove(),adminPanel()}})}function editMember(a){$.ajax({url:"/getUsers",type:"GET",dataType:"html",success:function(b){b=JSON.parse(b);for(let c=0;c<b.length;c++)if(b[c].id==+a){let d={};d.create_patronymic=$("#edit_patronymic").val(),d.create_email=$("#edit_email").val(),d.create_role=$("#edit_role").val(),d.create_password=$("#edit_password").val(),d.create_last_name=b[c].second_name,d.create_first_name=b[c].name,d.create_login=b[c].login,d.id=+a,$.ajax({url:"/addUser",type:"GET",data:d,dataType:"html",success:function(){$(".card_menu").remove(),adminPanel()}})}}})}function adminPanel(){$.ajax({url:"/getThisUser",type:"GET",dataType:"html",success:function(a){if(a=JSON.parse(a),"admin"==a.role){function a(){$.ajax({url:"/getUsers",type:"GET",dataType:"html",success:function(a){a=JSON.parse(a);for(let b=0;b<a.length;b++)"admin"==a[b].role&&(a[b].role="\u0410\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440"),"manager"==a[b].role&&(a[b].role="\u041C\u0435\u043D\u0435\u0434\u0436\u0435\u0440"),$("#admin").append(`
                                    <tr id="${a[b].id}" onclick="userInfo(this)">
                                        <td>${a[b].second_name}</td>
                                        <td>${a[b].name}</td>
                                        <td>${a[b].third_name}</td>
                                        <td>${a[b].role}</td>
                                        <td>${a[b].email}</td>
                                        <td>${a[b].login}</td>
                                        <td>${a[b].password}</td>
                                    </tr>
                                `)}})}$(".info").empty(),$("[name=\"linkCategory\"]").removeClass("active"),$("#mini_logo").addClass("active"),function(){$(".info").append(`
                        <div class="row">
                            <div class="fields">
                                <div class="btn btn-main btn-div" id="addNewPerson">Добавить сотрудника</div>
                            </div>
                            <div class="category">АДМИН ПАНЕЛЬ</div>
                        </div>
                        <table class="table" id="admin">
                            <tr>
                                <th width="170">Фамилия</th>
                                <th width="170">Имя</th>
                                <th width="170">Отчество</th>
                                <th width="130">Должность</th>
                                <th width="170">Email</th>
                                <th width="120">Логин</th>
                                <th width="150">Пароль</th>
                            </tr>
                        </table>`),a()}(),$("#addNewPerson").click(function(){$(".table, .card_menu").remove(),$(".info").append(`
                        <div class="card_menu persons" id="card_menu">
                            <div class="title">
                                <div class="left_side">
                                    <span>Добавление сотрудника</span>
                                </div>
                                <div class="right_side">
                                    <div class="close" onclick="closePersonCard()">
                                        <img src="static/images/cancel.png">
                                    </div>
                                </div>
                            </div>
                            <div class="content">
                                <div class="row_card">
                                    <table class="table_block">
                                        <tr>
                                            <td>Фамилия</td>
                                            <td>
                                                <input type="text" id="create_last_name">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Имя</td>
                                            <td>
                                                <input type="name" id="create_first_name">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Отчество</td>
                                            <td>
                                                <input type="text" id="create_patronymic">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Должность</td>
                                            <td>
                                                <select type="text" id="create_role">
                                                    <option value="null" selected disabled>Не выбран</option>
                                                    <option value="admin">Администратор</option>
                                                    <option value="manager">Менеджер</option>
                                                </select>
                                            </td>
                                        </tr>
                                    </table>
                                    <table class="table_block">
                                        <tr>
                                            <td>Email</td>
                                            <td>
                                                <input type="email" id="create_email">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Логин</td>
                                            <td>
                                                <input type="login" id="create_login">
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Пароль</td>
                                            <td>
                                                <input type="text" id="create_password">
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div class="next">
                                    <button class="btn btn-main" onclick="createNewMember()">Добавить</button>
                                </div>
                            </div>
                        </div>`)})}}})}function createNewMember(){let a=["create_last_name","create_first_name","create_patronymic","create_role","create_password","create_login","create_email"],b={};for(let c=0;c<a.length;c++)if(b[a[c]]=$(`#${a[c]}`).val(),""==$(`#${a[c]}`).val()&&"create_email"!=a[c]&&"create_patronymic"!=a[c]||null==$(`#${a[c]}`).val())return alert("\u0412\u0441\u0435 \u043F\u043E\u043B\u044F, \u043A\u0440\u043E\u043C\u0435 \u043F\u043E\u0447\u0442\u044B \u0438 \u043E\u0442\u0447\u0435\u0441\u0442\u0432\u0430, \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u044B \u043A \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044E!");b.id="new",$.ajax({url:"/addUser",data:b,type:"GET",dataType:"html",success:function(){closePersonCard()}})}function getValidationDate(a){let b=/(\d\d)\.(\d\d)\.(\d\d)/,c=b.exec(a),d=new Date("20"+ +c[3]-1,c[2],c[1]);return d}function analyticsFilterTable_0(a="all"){let b,c=function(){let b=[{id:"all",period:3650},{id:0,period:3650},{id:1,period:0},{id:2,period:7},{id:3,period:30},{id:4,period:365}];for(let c=0;c<b.length;c++)if(a==b[c].id){let a=getCurrentDate("year"),d=/(\d\d)\.(\d\d)\.(\d\d)/,e=d.exec(a),f=new Date("20"+ +e[3]-1,e[2],e[1]),g=new Date("20"+ +e[3]-1,e[2],e[1]);return g.setDate(g.getDate()-b[c].period),[g,f]}}();$.ajax({url:"/getAccounts",type:"GET",async:!1,dataType:"html",success:function(a){b=JSON.parse(a)}});let d=[];for(let e,f=0;f<b.length;f++)if(e=getValidationDate(b[f].account.Date),e>=c[0]&&e<=c[1])for(let a=0;a<b[f].items.length;a++)d.push({item:b[f].items[a],account:[b[f].account]});for(let b=0;b<d.length-1;b++)for(let a=b+1;a<d.length;a++)if(d[b].item.Item_id==d[a].item.Item_id){for(let c=0;c<d[a].account.length;c++)d[b].account.push(d[a].account[c]);d.splice(a,1),a--}return`
            <table class="table analytics">
                <tr>
                    <th>Товар</th>
                    <th width="270">Клиент</th>
                    <th>Объем</th>
                    <th>Цена</th>
                    <th>Доставка</th>
                    <th>Привет</th>
                    <th>Себестоимость</th>
                    <th>Закупочная цена</th>
                    <th>Заработали</th>
                    <th>Прибыль</th>
                </tr>
                ${function(){let a="";for(let b=0;b<d.length;b++)for(let c=0;c<d[b].account.length;c++){let e=JSON.parse(d[b].account[c].Item_ids),f=JSON.parse(d[b].account[c].Shipping),g=JSON.parse(d[b].account[c].Hello);for(let h=0;h<e.length;h++)if(+e[h].id==+d[b].item.Item_id){function i(){let a="";0==c&&(a+=`<td rowspan="${d[b].account.length}">${d[b].item.Name}</td>`);let i=+f[h]+ +g[h]+Math.round(+d[b].item.Cost/+d[b].item.Volume);return a+=`<td>${d[b].account[c].Name}</td>
                                            <td>${e[h].volume}</td>
                                            <td>${i}</td>
                                            <td>${f[h]}</td>
                                            <td>${g[h]}</td>
                                            <td>${Math.round(+d[b].item.Cost/+d[b].item.Volume)}</td>
                                            <td>${d[b].item.Purchase_price}</td>
                                            <td>${Math.round(+d[b].item.Cost/+d[b].item.Volume)-+d[b].item.Purchase_price}</td>
                                            <td>${(Math.round(+d[b].item.Cost/+d[b].item.Volume)-+d[b].item.Purchase_price)*+e[h].volume}</td>`,a}let j=`<tr>${i()}</tr>`;a+=j}}return a}()}
            </table>
        `}function analyticsFilterTable_1(a="all"){function b(){function a(a){let b=JSON.parse(a.Item_ids);for(let d=0;d<c.length;d++){let f=JSON.parse(c[d].account.Item_ids),g=getValidationDate(c[d].account.Date);if(a.Name===c[d].account.Name&&a.id!==c[d].account.id&&g>=e[0]&&g<=e[1]){for(let a=0;a<f.length;a++)b.push(f[a]);for(let a=0;a<b.length-1;a++)for(let c=a+1;c<b.length;c++)b[a].id===b[c].id&&(b[a].volume=+b[a].volume+ +b[c].volume,b.splice(c,1),c--);c.splice(d,1),d--}}return b}$.ajax({url:"/getAccounts",type:"GET",async:!1,dataType:"html",success:function(a){c=JSON.parse(a)}});let b=[];for(let a=0;a<f.length;a++)b[a]=0;let d="";for(let g,h=0;h<c.length;h++)if(g=getValidationDate(c[h].account.Date),g>=e[0]&&g<=e[1]){let e=a(c[h].account);e.sort(function(c,a){return c.id>a.id?1:c.id<a.id?-1:0}),d+=`
                        <tr>
                            <td>${c[h].account.Name}</td>
                            ${function(){let a="";for(let c=0;c<e.length;c++)for(let d=0;d<f.length;d++)+f[d].Item_id==+e[c].id?(b[d]+=+e[c].volume,a+=`<td id="item_${d+1}">${e[c].volume}</td>`,e.length-1!=c&&c++):a+=`<td id="item_${d+1}">0</td>`;return a}()}
                        </tr>
                    `}let g=`<tr>${function(){let a="<td></td>";for(let c=0;c<b.length;c++)a+=`<td class="bold">${b[c]}</td>`;return a}()}</tr>`;return d+=g,d}let c,d,e=function(){let b=[{id:"all",period:3650},{id:0,period:3650},{id:1,period:0},{id:2,period:7},{id:3,period:30},{id:4,period:365}];for(let c=0;c<b.length;c++)if(a==b[c].id){let a=getCurrentDate("year"),d=/(\d\d)\.(\d\d)\.(\d\d)/,e=d.exec(a),f=new Date("20"+ +e[3]-1,e[2],e[1]),g=new Date("20"+ +e[3]-1,e[2],e[1]);return g.setDate(g.getDate()-b[c].period),[g,f]}}();$.ajax({url:"/getStockTable",type:"GET",async:!1,dataType:"html",success:function(a){d=JSON.parse(a)}});let f=[];for(let b=0;b<d.length;b++)for(let a=0;a<d[b].items.length;a++)f.push(d[b].items[a]);return f.sort(function(c,a){return c.Item_id>a.Item_id?1:c.Item_id<a.Item_id?-1:0}),`
            <table class="table analytics">
                <tr>
                    <th width="270">Клиент</th>
                    ${function(){let a="";for(let b=0;b<f.length;b++)a+=`<th width="70">${f[b].Name}</th>`;return a}()}
                </tr>
                ${b()}
            </table>
        `}function analyticsFilterTable_2(a="all"){function b(){let a="";for(let b=0;b<f.length;b++)for(let c=0;c<f[b].items.length;c++){let e=JSON.parse(f[b].account.Item_ids),g=JSON.parse(f[b].account.Items_amount);for(let h=0;h<e.length;h++)for(let i,j=0;j<d.length;j++){i=JSON.parse(d[j].delivery.Item_ids);for(let k=0;k<i.length;k++)if(+e[h].id==+f[b].items[c].Item_id&&+f[b].items[c].Item_id==+i[k]&&d[j].delivery.Account_id==+f[b].account.id){function i(){let a="";return 0==c&&(a+=`<td rowspan="${f[b].items.length}">${f[b].account.Name}</td>`),a+=`<td>${f[b].items[c].Name}</td>
                                                    <td>${e[h].volume}</td>
                                                    <td>${null==d[j].delivery.Start_date?"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D\u0430":d[j].delivery.Start_date}</td>
                                                    <td>${g[h].amount}</td>`,a}let k=`<tr>${i()}</tr>`;a+=k}}}return a}let c,d,e=function(){let b=[{id:"all",period:3650},{id:0,period:3650},{id:1,period:0},{id:2,period:7},{id:3,period:30},{id:4,period:365}];for(let c=0;c<b.length;c++)if(a==b[c].id){let a=getCurrentDate("year"),d=/(\d\d)\.(\d\d)\.(\d\d)/,e=d.exec(a),f=new Date("20"+ +e[3]-1,e[2],e[1]),g=new Date("20"+ +e[3]-1,e[2],e[1]);return g.setDate(g.getDate()-b[c].period),[g,f]}}();$.ajax({url:"/getAccounts",type:"GET",async:!1,dataType:"html",success:function(a){c=JSON.parse(a)}}),$.ajax({url:"/getDeliveries",type:"GET",async:!1,dataType:"html",success:function(a){d=JSON.parse(a)}});let f=[];for(let b,d=0;d<c.length;d++)if(b=getValidationDate(c[d].account.Date),b>=e[0]&&b<=e[1])for(let a=0;a<c[d].items.length;a++)f.push({items:[c[d].items[a]],account:c[d].account});for(let b=0;b<f.length-1;b++)for(let a=b+1;a<f.length;a++)if(f[b].account.Name===f[a].account.Name&&f[b].account.id===f[a].account.id){for(let c=0;c<f[a].items.length;c++)f[b].items.push(f[a].items[c]);if(f[b].account.id!==f[a].account.id){let c=JSON.parse(f[a].account.Item_ids),d=JSON.parse(f[a].account.Items_amount),e=JSON.parse(f[b].account.Item_ids),h=JSON.parse(f[b].account.Items_amount);for(let a=0;a<c.length;a++)e.push(c[a]),h.push(d[a]);for(let a=0;a<e.length-1;a++)for(let b=a+1;b<e.length;b++)e[a].id===e[b].id&&(e[a].volume=+e[a].volume+ +e[b].volume,e.splice(b,1),b--);f[b].account.Item_ids=JSON.stringify(e),f[b].account.Items_amount=JSON.stringify(h)}f.splice(a,1),a--}return`
            <table class="table analytics">
                <tr>
                    <th width="350">Клиент</th>
                    <th>Товары</th>
                    <th>Вес</th>
                    <th>Дата отгрузки</th>
                    <th>Сумма</th>
                </tr>
                ${b()}
            </table>
        `}function analyticsFilterTable_3(a="all"){let b=function(){let b=[{id:"all",period:3650},{id:0,period:3650},{id:1,period:0},{id:2,period:7},{id:3,period:30},{id:4,period:365}];for(let c=0;c<b.length;c++)if(a==b[c].id){let a=getCurrentDate("year"),d=/(\d\d)\.(\d\d)\.(\d\d)/,e=d.exec(a),f=new Date("20"+ +e[3]-1,e[2],e[1]),g=new Date("20"+ +e[3]-1,e[2],e[1]);return g.setDate(g.getDate()-b[c].period),[g,f]}}();return`
            <table class="table analytics">
                <tr>
                    <th width="350">Клиент</th>
                    <th>Объём</th>
                    <th>Сколько</th>
                    <th>Сумма</th>
                    <th>Итого</th>
                </tr>
                ${function(){let a;$.ajax({url:"/getAccounts",type:"GET",async:!1,dataType:"html",success:function(b){a=JSON.parse(b)}});let c="",d=[];for(let c,e=0;e<a.length;e++)if(c=getValidationDate(a[e].account.Date),c>=b[0]&&c<=b[1]){let b=JSON.parse(a[e].account.Item_ids),c=JSON.parse(a[e].account.Hello),f=b.reduce((c,a)=>({volume:+c.volume+ +a.volume})),g=0,h=0,i=categoryInListClient[1][1];for(let b=0;b<i.length;b++)if(i[b].Name===a[e].account.Name){h=i[b].id;break}for(let a=0;a<b.length;a++)g+=+b[a].volume*+c[a];d.push({client_id:h,name:a[e].account.Name,volume:+f.volume,average_volume:Math.ceil(+g/+f.volume),amount_hello:Math.ceil(+g),amount:Math.round(.9*+a[e].account.Sum)})}for(let a=0;a<d.length-1;a++)for(let b=a+1;b<d.length;b++)d[a].name===d[b].name&&(d[a].volume+=d[b].volume,d[a].amount_hello+=d[b].amount_hello,d[a].average_volume=Math.ceil(d[a].amount_hello/d[a].volume),d[a].amount=Math.round(.9*(d[a].amount+d[b].amount)),d.splice(b,1),b--);for(let a=0;a<d.length;a++)c+=`
                    <tr id="client_${d[a].client_id}_search" onclick="openCardMenu(this)">
                        <td>${d[a].name}</td>
                        <td>${d[a].volume}</td>
                        <td>${d[a].average_volume}</td>
                        <td>${d[a].amount_hello}</td>
                        <td>${d[a].amount}</td>
                    </tr>
                `;return c}()}
            </table>
        `}function analyticsFilterTable_4(a="all"){function b(a){let b=e.slice(),c=JSON.parse(a.Items_amount);for(let d=0;d<b.length;d++){let e=JSON.parse(b[d].account.Items_amount),g=getValidationDate(b[d].account.Date);if(a.Manager_id==b[d].account.Manager_id&&a.id!=b[d].account.id&&g>=f[0]&&g<=f[1]){for(let a=0;a<e.length;a++)c.push(e[a]);for(let a=0;a<c.length-1;a++)for(let b=a+1;b<c.length;b++)c[a].id===c[b].id&&(c[a].amount=+c[a].amount+ +c[b].amount,c.splice(b,1),b--);b.splice(d,1),d--}}return c}function c(a){let b=e.slice(),c=JSON.parse(a.Item_ids);for(let d=0;d<b.length;d++){let e=JSON.parse(b[d].account.Item_ids),g=getValidationDate(b[d].account.Date);if(a.Manager_id==b[d].account.Manager_id&&a.id!=b[d].account.id&&g>=f[0]&&g<=f[1]){for(let a=0;a<e.length;a++)c.push(e[a]);for(let a=0;a<c.length-1;a++)for(let b=a+1;b<c.length;b++)c[a].id===c[b].id&&(c[a].volume=+c[a].volume+ +c[b].volume,c.splice(b,1),b--);b.splice(d,1),d--}}return c}let d,e,f=function(){let b=[{id:"all",period:3650},{id:0,period:3650},{id:1,period:0},{id:2,period:7},{id:3,period:30},{id:4,period:365}];for(let c=0;c<b.length;c++)if(a==b[c].id){let a=getCurrentDate("year"),d=/(\d\d)\.(\d\d)\.(\d\d)/,e=d.exec(a),f=new Date("20"+ +e[3]-1,e[2],e[1]),g=new Date("20"+ +e[3]-1,e[2],e[1]);return g.setDate(g.getDate()-b[c].period),[g,f]}}();$.ajax({url:"/getAccounts",type:"GET",async:!1,dataType:"html",success:function(a){e=JSON.parse(a)}}),$.ajax({url:"/getStockTable",type:"GET",async:!1,dataType:"html",success:function(a){d=JSON.parse(a)}});let g=[];for(let b=0;b<d.length;b++)for(let a=0;a<d[b].items.length;a++)g.push(d[b].items[a]);g.sort(function(c,a){return c.Item_id>a.Item_id?1:c.Item_id<a.Item_id?-1:0});let h=[],j=0;for(let b=0;b<g.length;b++)h[b]=0;return`
            <table class="table analytics">
                <tr>
                    <th width="170">Менеджер</th>
                    <th width="130">Итого</th>
                    ${function(){let a="";for(let b=0;b<g.length;b++)a+=`<th width="70">${g[b].Name}</th>`;return a}()}
                </tr>
                ${function(){function a(a){let d="";for(let k,l=0;l<e.length;l++)if(k=getValidationDate(e[l].account.Date),e[l].account.Manager_id==a&&k>=f[0]&&k<=f[1]){let a=c(e[l].account),f=b(e[l].account);a.sort(function(c,a){return c.id>a.id?1:c.id<a.id?-1:0}),f.sort(function(c,a){return c.id>a.id?1:c.id<a.id?-1:0});let i=0;for(let a=0;a<f.length;a++)i+=Math.round(+f[a].amount);j+=i,d+=`<td>${i}</td>`;for(let b=0;b<a.length;b++)for(let c=0;c<g.length;c++)+g[c].Item_id==+a[b].id?(h[c]+=+a[b].volume,d+=`<td id="item_${c+1}">${a[b].volume}</td>`,a.length-1!=b&&b++):d+=`<td id="item_${c+1}">0</td>`;break}return d}function d(b){for(let c=0;c<e.length;c++)if(e[c].account.Manager_id==b)return a(b);return`<td>0</td><td>0</td><td>0</td><td>0</td>`}function i(){let a=`<td></td><td>${j}</td>`;for(let b=0;b<h.length;b++)a+=`<td class="bold">${h[b]}</td>`;return a}let k;$.ajax({url:"/getUsers",type:"GET",async:!1,dataType:"html",success:function(a){k=JSON.parse(a)}});let l=[];for(let a=0;a<k.length;a++)"manager"===k[a].role&&l.push(k[a]);let m="";for(let a=0;a<l.length;a++)m+=`
                    <tr>
                        <td>${l[a].second_name}</td>
                        ${d(l[a].id)}
                    </tr>
                `;let n=`<tr>${i()}</tr>`;return m+=n,m}()}
            </table>
        `}