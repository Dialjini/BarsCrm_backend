function current_count_accounts(e,t,n){let r=[{type:1,array:[{numbers:[1],name:""},{numbers:[2,3,4],name:"а"},{numbers:[5,6,7,8,9,0],name:"ов"}]},{type:2,array:[{numbers:[1],name:"а"},{numbers:[2,3,4],name:"и"},{numbers:[5,6,7,8,9,0],name:"ов"}]},{type:3,array:[{numbers:[1],name:"й"},{numbers:[2,3,4],name:"я"},{numbers:[5,6,7,8,9,0],name:"ев"}]}],a="1";for(let t=1;t<String(e).length;t++)a+="0";for(let l=0;l<r.length;l++)if(r[l].type==n)for(let n=0;n<r[l].array.length;n++)for(let i=0;i<r[l].array[n].numbers.length;i++){if(1==Math.floor(+e/+a)&&"1"!=a)return t+"ов";if(e%10==r[l].array[n].numbers[i])return t+r[l].array[n].name}}let rowFilling=(e,t,n)=>{let r=e[1],a=()=>{let n=$("<tr>");for(let a=0;a<e[0].length-1;a++){if(2==a&&"stock"==t){function r(){let e;return $.ajax({url:"/getThisUser",type:"GET",dataType:"html",async:!1,success:function(t){e=JSON.parse(t)}}),"admin"==e.role?'<button class="btn btn-add-items" id="item_add" onclick="createCardMenu(this)">Добавить</button>':""}elementTr=`\n                <th width="${e[0][a].width}%">\n                    <div class="flex jc-sb">\n                        <span>${e[0][a].name}</span>\n                        ${r()}\n                    </div>\n                </th>`}else elementTr=3==a&&"client"==t||1==a&&"provider"==t||1==a&&"filter_provider"==t||2==a&&"carrier"==t?`\n                <th id="all_area" onclick="selectFilterArea(this)" width="${e[0][a].width}%">\n                    <div class="flex jc-sb">\n                        <span>${e[0][a].name}</span>\n                        <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                    </div>\n                </th>`:3==a&&"provider"==t||3==a&&"filter_provider"==t?`\n                <th id="pd_group" onclick="selectGroupProduct(this)" width="${e[0][a].width}%">\n                    <div class="flex jc-sb">\n                        <span>${e[0][a].name}</span>\n                        <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                    </div>\n                </th>`:4==a&&"provider"==t||4==a&&"filter_provider"==t?`\n                <th id="pd_price" onclick="selectFilterPrice(this)" width="${e[0][a].width}%">\n                    <div class="flex jc-sb">\n                        <span>${e[0][a].name}</span>\n                        <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                    </div>\n                </th>`:4==a&&"client"==t?`\n                <th id="cl_category" onclick="selectFilterCategory(this)" width="${e[0][a].width}%">\n                    <div class="flex jc-sb">\n                        <span>${e[0][a].name}</span>\n                        <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                    </div>\n                </th>`:4==a&&"delivery"==t||4==a&&"filter_delivery"==t?`\n                <th id="dl_customer" onclick="selectFilterCustomer(this)" width="${e[0][a].width}%">\n                    <div class="flex jc-sb">\n                        <span>${e[0][a].name}</span>\n                        <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                    </div>\n                </th>`:7==a&&"delivery"==t||7==a&&"filter_delivery"==t?`\n                <th id="dl_status" onclick="selectFilterStatus(this)" width="${e[0][a].width}%">\n                    <div class="flex jc-sb">\n                        <span>${e[0][a].name}</span>\n                        <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                    </div>\n                </th>`:`<th width="${e[0][a].width}%">${e[0][a].name}</th>`;n.append(elementTr)}return"delivery"!==t&&"stock"!==t?n.append(`\n            <th id="pd_manager" onclick="selectManager(this)" width="${e[0][e[0].length-1].width}%">\n                <div class="flex jc-sb">\n                    <span>${e[0][e[0].length-1].name}</span>\n                    <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                </div>\n            </th>`):"delivery"==t||"filter_delivery"==t?n.append(`\n            <th id="dl_date" onclick="selectFilterDate(this)" width="${e[0][e[0].length-1].width}%">\n                <div class="flex jc-sb">\n                    <span>${e[0][e[0].length-1].name}</span>\n                    <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                </div>\n            </th>`):n.append(`<th width="${e[0][e[0].length-1].width}%">${e[0][e[0].length-1].name}</th>`),n},l=e=>{let t;n.append(a()),$.ajax({url:"/getUsers",type:"GET",async:!1,dataType:"html",success:function(e){t=JSON.parse(e)}});for(let a=0;a<r.length;a++){let l;for(let e=0;e<t.length;e++){if(+t[e].id==+r[a].Manager_id&&r[a].Manager_active){l=t[e].second_name;break}l="Не выбран"}let i,s=[{id:"client",list:[r[a].id,r[a].Name,r[a].Oblast,r[a].Rayon,r[a].Category,l]},{id:"carrier",list:[r[a].Name,r[a].Region,r[a].Area,returnSpaces(r[a].Capacity),r[a].View,l]}];for(let t=0;t<s.length;t++)if(s[t].id===e){i=s[t].list;break}let o=$("<tr>",{id:`${e}_${r[a].id}`,onclick:"createCardMenu(this)"});for(let e=0;e<i.length;e++){let t=i[e];null!==t&&""!==t||(t="Не указано");let n=$("<td>",{html:t});o.append(n)}n.append(o)}return n};function i(e){"filter_provider"!=e?($("#info_in_accounts").remove(),$(".fields").append(`\n            <div id="info_in_accounts">\n                <span id="info_in_accounts_count" style="margin-right: 5px;">${r.length}</span> \n                <div id="select_period_info_accounts" onclick="visibleSelectPeriod('provider')">\n                    <span id="period_accounts">за последний месяц</span> <img src="static/images/dropmenu_black.svg" class="drop_down_img">\n                </div>\n            </div>\n        `)):$("#info_in_accounts_count").html(`${r.length}`)}let s=e=>{n.append(a());let t=r.length;for(let e=r.length-1;e>=0;e--){if("not-document"==r[e].delivery.Type){t--;continue}let a=r[e].delivery.Payment_list,l=0;if(null==a&&(a=""),a.length>0){a=JSON.parse(r[e].delivery.Payment_list);for(let e=0;e<a.length;e++)l+=+deleteSpaces(a[e].price)}let i=$("<tr>",{id:`delivery_${e+1}`,onclick:"createDelCardMenu(this)"}),s=null==r[e].carrier?"Не выбран":r[e].carrier.Name;r[e].delivery.NDS=r[e].delivery.NDS[0]+r[e].delivery.NDS[1];let o=0,c=null!=r[e].delivery.Amounts?JSON.parse(r[e].delivery.Amounts):[],d="ООО"==r[e].delivery.Customer?"":1.26;for(let e=0;e<c.length;e++)o+=+deleteSpaces(c[e].sum);let p=+o-+l<=0?'<span class="green">Оплачено</span>':'<span class="red">Не оплачено</span>',u=returnSpaces(Math.ceil(o*d)),m=r[e].delivery.Customer,_=r[e].delivery.Payment_date;"Транзит"==r[e].delivery.Name?full_name=`Транзит с ${r[e].delivery.Stock} на ${r[e].delivery.Contact_Number}`:full_name=r[e].delivery.Name;let f=r[e].delivery.Stock;-1!=f.indexOf("-s!s-")&&(f=f.replace(/-s!s-/g," | "));const h=[r[e].delivery.Date,full_name,f,s,r[e].delivery.Customer,"ООО"==m?returnSpaces(o):u,"ООО"==m?"":returnSpaces(o),p,""==_?"Не указано":_];for(let e=0;e<h.length;e++){let t=$("<td>",{html:h[e]});i.append(t)}n.append(i)}return"filter_delivery"!=e?($("#info_in_accounts").remove(),$(".fields").append(`\n                <div id="info_in_accounts">\n                    <span id="info_in_accounts_count" style="margin-right: 5px;">${t} ${current_count_accounts(r.length,"доставк",2)}</span> \n                    <div id="select_period_info_accounts" onclick="visibleSelectPeriod('delivery')">\n                        <span id="period_accounts">за последний месяц</span> <img src="static/images/dropmenu_black.svg" class="drop_down_img">\n                    </div>\n                </div>\n            `)):$("#info_in_accounts_count").html(`${t} ${current_count_accounts(r.length,"доставк",2)}`),n},o=e=>{n.append(a());let t,l=$("<tbody>");$.ajax({url:"/getUsers",type:"GET",async:!1,dataType:"html",success:function(e){t=JSON.parse(e)}});for(let e=r.length-1;e>=0;e--){if(null!=r[e].account.Payment_history){let t=JSON.parse(r[e].account.Payment_history),n=deleteSpaces(r[e].account.Sum),a=0;for(let e=0;e<t.length;e++)a+=+deleteSpaces(t[e].sum);status=+n<=+a?'<span class="green">Оплачено</span>':0==+a?'<span class="red">Не оплачено</span>':'<span class="red">Частично оплачено</span>',"true"==r[e].account.Status&&(status='<span style="color: #e8e8e8">Не актуальный</span>')}else status='<span class="red">Не оплачено</span>';let a;"false"==r[e].account.Shipment?(shipment='<span class="red">Не отгружено</span>',"true"==r[e].account.Status&&(shipment='<span style="color: #e8e8e8">Не отгружено</span>')):"true"==r[e].account.Shipment?(shipment='<span class="green">Отгружено</span>',"true"==r[e].account.Status&&(shipment='<span style="color: #e8e8e8">Отгружено</span>')):(shipment='<span class="red">Частично отгружено</span>',"true"==r[e].account.Status&&(shipment='<span style="color: #e8e8e8">Частично отгружено</span>'));for(let n=0;n<t.length;n++){if(+t[n].id==+r[e].account.Manager_id){a=null==t[n].second_name?"Фамилия не указана":t[n].second_name;break}a="Не выбран"}let i=0,s=JSON.parse(r[e].account.Hello);for(let e=0;e<s.length;e++)i+=+deleteSpaces(s[e]);let o=$("<tr>",{id:`account_${e+1}`,onclick:"createCardMenu(this)"});const c=[r[e].items[0].Prefix,r[e].account.Date,r[e].account.Name,returnSpaces(r[e].account.Sum),status,shipment,returnSpaces(+i.toFixed(2)),a];for(let e=0;e<c.length;e++){let t=status.includes("Не актуальный")?$("<td>",{html:`<span style="color: #e8e8e8">${c[e]}</span>`}):$("<td>",{html:c[e]});o.append(t)}"true"==r[e].account.Status?l.append(o):n.append(o)}return n.append(l),"filter_account"!=e?$(".fields").append(`\n                <div id="info_in_accounts">\n                    <span id="info_in_accounts_count" style="margin-right: 5px;">${r.length} ${current_count_accounts(r.length,"счет",1)}</span> \n                    <div id="select_period_info_accounts" onclick="visibleSelectPeriod()">\n                        <span id="period_accounts">за последний месяц</span> <img src="static/images/dropmenu_black.svg" class="drop_down_img">\n                    </div>\n                </div>\n            `):$("#info_in_accounts_count").html(`${r.length} ${current_count_accounts(r.length,"счет",1)}`),n},c=e=>{let t,l;$.ajax({url:"/getUsers",type:"GET",async:!1,dataType:"html",success:function(e){l=JSON.parse(e),$.ajax({url:"/getDeliveries",type:"GET",async:!1,dataType:"html",success:function(e){t=JSON.parse(e)}})}}),$(n).attr("class","table analytics"),n.append(a());let i=0,s=0;for(let e=r.length-1;e>=0;e--){let a;for(let t=0;t<l.length;t++){if(+l[t].id==+r[e].account.Manager_id){a=null==l[t].second_name?"Фамилия не указана":l[t].second_name;break}a="Не выбран"}let o=0,c=0,d=[{sum:0,date:""}];if(null!=r[e].account.Payment_history){d=JSON.parse(r[e].account.Payment_history);for(let e=0;e<d.length;e++)o+=+deleteSpaces(d[e].sum)}else o=0;if(null!=r[e].account.Items_amount){let t=JSON.parse(r[e].account.Items_amount);for(let e=0;e<t.length;e++)c+=+deleteSpaces(t[e].amount)}else c=0;let p=r[e].account.Shipment;for(let e=0;e<d.length;e++)if((0!=d[e].sum||"false"!==p)&&+deleteSpaces(r[e].account.Sum)>+deleteSpaces(o)){i+=c-o,s++;break}let u=0,m=[];for(let n=0;n<t.length;n++)t[n].delivery.Account_id==e+1&&(u++,m.push({first_date:t[n].delivery.Start_date,id:t[n].delivery.Account_id,postponement_date:t[n].delivery.Postponement_date,customer:t[n].delivery.Customer}));for(let e=0;e<m.length;e++)""!=m[e].first_date&&null!=m[e].first_date||(m[e].first_date="Не указано"),""!=m[e].postponement_date&&null!=m[e].postponement_date||(m[e].postponement_date="Не указано");if(0==o&&"false"==p)continue;if(+deleteSpaces(r[e].account.Sum)<=+deleteSpaces(o))continue;let _=$("<tbody>",{id:`account_${e+1}`,onclick:"transferToAccounts(this)",class:"tr_tr"});for(let t=0;t<m.length;t++)0==t?_.append(`\n                        <tr>\n                            <td>${m[t].customer}</td>\n                            <td rowspan="${u}">${r[e].account.Name}</td>\n                            <td>${m[t].first_date}</td>\n                            <td>${m[t].postponement_date}</td>\n                            <td rowspan="${u}">${returnSpaces(r[e].account.Sum)}</td>\n                            <td rowspan="${u}">${returnSpaces(o)}</td>\n                            <td rowspan="${u}">${returnSpaces(+deleteSpaces(r[e].account.Sum)-+deleteSpaces(o))}</td>\n                            <td rowspan="${u}">${a}</td>\n                        </tr>\n                    `):_.append(`\n                        <tr>\n                            <td>${m[t].customer}</td>\n                            <td>${m[t].first_date}</td>\n                            <td>${m[t].postponement_date}</td>\n                        </tr>\n                    `);for(let e=0;e<name.length;e++){let t=$("<td>",{html:name[e]});_.append(t)}n.append(_)}return"filter_debit"!=e?($("#info_in_accounts").remove(),$(".fields").append(`\n            <div id="info_in_accounts">\n                <span id="info_in_accounts_count">${s} ${current_count_accounts(s,"счет",1)} на </span> \n                <span id="info_in_accounts_amount" class="red">${returnSpaces(i)} руб.</span>\n                <div id="select_period_info_accounts" onclick="visibleSelectPeriod()">\n                    <span id="period_accounts">за последний месяц</span> <img src="static/images/dropmenu_black.svg" class="drop_down_img">\n                </div>\n            </div>\n        `)):($("#info_in_accounts_count").html(`${s} ${current_count_accounts(s,"счет",1)} на `),$("#info_in_accounts_amount").html(`${returnSpaces(i)} руб.`)),n},d=e=>{n.append(a());for(let e=r.length-1;e>=0;e--)for(let t=r[e].items.length-1;t>=0;t--)if(null!=r[e].stock_address){let a=$("<tr>",{id:`stock_${r[e].items[t].Item_id}`,onclick:"createCardMenu(this, 1)"});const l=[r[e].items[t].Prefix,r[e].items[t].Group_name,r[e].items[t].Name,returnSpaces(r[e].items[t].Weight),r[e].items[t].Packing,returnSpaces(r[e].items[t].Volume),returnSpaces(r[e].items[t].Cost),r[e].items[t].NDS,r[e].stock_address];for(let e=0;e<l.length;e++){let t=$("<td>",{html:l[e]});a.append(t)}n.append(a)}return n};const p=[{id:"client",function:l},{id:"provider",function:e=>{let t;n.append(a()),$.ajax({url:"/getUsers",type:"GET",async:!1,dataType:"html",success:function(e){t=JSON.parse(e)}});for(let e=r.length-1;e>=0;e--){let a,l=$("<tbody>",{id:`provider_${r[e].id}`,name:"provider",onclick:"createCardMenu(this)"});for(let n=0;n<t.length;n++){if(+t[n].id==+r[e].Manager_id&&r[e].Manager_active){a=t[n].second_name;break}a="Не выбран"}let i=JSON.parse(r[e].Item_list);null==i&&(i=[{item_product:"",item_price:""}]);let s=null==r[e].Oblast?"Не указано":r[e].Oblast,o=null==r[e].Rayon?"Не указано":r[e].Rayon,c=null==r[e].Name?"Не указано":r[e].Name;if(l.append(`\n                <tr>\n                    <td rowspan="${0==i.length?1:i.length}">${s}</td>\n                    <td rowspan="${0==i.length?1:i.length}">${o}</td>\n                    <td rowspan="${0==i.length?1:i.length}">${c}</td>\n                    <td>${i[0].item_product}</td>\n                    <td>${returnSpaces(i[0].item_price)}</td>\n                    <td rowspan="${0==i.length?1:i.length}">${a}</td>\n                </tr>\n            `),null!=(i=JSON.parse(r[e].Item_list)))for(let e=1;e<i.length;e++)l.append(`\n                    <tr>\n                        <td>${i[e].item_product}</td>\n                        <td>${returnSpaces(i[e].item_price)}</td>\n                    </tr>\n                    `);n.append(l)}return i(e),n}},{id:"filter_provider",function:e=>{let t;n.append(a()),$.ajax({url:"/getUsers",type:"GET",async:!1,dataType:"html",success:function(e){t=JSON.parse(e)}});for(let e=r.length-1;e>=0;e--){let a,l=$("<tbody>",{id:`provider_${r[e].id}`,name:"provider",onclick:"createCardMenu(this)"});for(let n=0;n<t.length;n++){if(+t[n].id==+r[e].Manager_id&&r[e].Manager_active){a=t[n].second_name;break}a="Не выбран"}let i=JSON.parse(r[e].Item_list);null==i&&(i=[{item_product:"",item_price:""}]);let s=null==r[e].Oblast?"Не указано":r[e].Oblast,o=null==r[e].Rayon?"Не указано":r[e].Rayon,c=null==r[e].Name?"Не указано":r[e].Name;if(l.append(`\n                <tr>\n                    <td rowspan="${0==i.length?1:i.length}">${s}</td>\n                    <td rowspan="${0==i.length?1:i.length}">${o}</td>\n                    <td rowspan="${0==i.length?1:i.length}">${c}</td>\n                    <td>${i[0].item_product}</td>\n                    <td>${returnSpaces(i[0].item_price)}</td>\n                    <td rowspan="${0==i.length?1:i.length}">${a}</td>\n                </tr>\n            `),null!=(i=JSON.parse(r[e].Item_list)))for(let e=1;e<i.length;e++)l.append(`\n                        <tr>\n                            <td>${i[e].item_product}</td>\n                            <td>${returnSpaces(i[e].item_price)}</td>\n                        </tr>\n                    `);n.append(l)}return i(e),n}},{id:"carrier",function:l},{id:"debit",function:c},{id:"filter_debit",function:c},{id:"account",function:o},{id:"filter_account",function:o},{id:"delivery",function:s},{id:"filter_delivery",function:s},{id:"stock",function:d},{id:"filter_stock",function:d},{id:"filter_stock_admin",function:e=>{n.append(a());for(let e=r.length-1;e>=0;e--)for(let t=r[e].items.length-1;t>=0;t--)if(null!=r[e].stock_address){let a=$("<tr>",{id:`stock_${r[e].items[t].Item_id}`,onclick:"editItem(this.id)"});const l=[r[e].items[t].Prefix,r[e].items[t].Group_name,r[e].items[t].Name,returnSpaces(r[e].items[t].Weight),r[e].items[t].Packing,returnSpaces(r[e].items[t].Volume),returnSpaces(r[e].items[t].Cost),r[e].items[t].NDS,r[e].stock_address];for(let e=0;e<l.length;e++){let t=$("<td>",{html:l[e]});a.append(t)}n.append(a)}return n}}];for(let e of p)if(e.id===t)return e.function(t)},competitor_data=[];function searchByCompetitor(){$.ajax({url:"/getAllClientItems",type:"GET",dataType:"html",success:function(e){let t=JSON.parse(e),n=[],r=[];for(let e=0;e<t.length;e++)for(let a=0;a<t[e].data.length;a++)"Выбрать"!==t[e].data[a].Name&&"Не выбран"!==t[e].data[a].Creator&&"Конкурентов нет"!==t[e].data[a].Creator&&(n.push(t[e].data[a].Client_id),r.push(t[e].data[a]));let a=categoryInListClient[1][1],l=[];for(let e=0;e<n.length;e++)for(let t=0;t<a.length;t++)n[e]===a[t].id&&l.push(a[t]);null!=filterClient[1][1]&&filterClient[1].pop(),filterClient[1][1]=[];for(let e=0;e<l.length-1;e++)for(let t=e+1;t<l.length;t++)l[e].id===l[t].id&&(l.splice(t,1),t--);$.ajax({url:"/getUsers",type:"GET",dataType:"html",success:function(e){e=JSON.parse(e),$(".page").append($("<div>",{class:"background"}).add(`\n                        <div class="modal_select modal_search search_by_competitor--client">\n                            <div class="title">\n                                <span>Поиск по конкурентам</span>\n                                <img onclick="closeModal()" src="static/images/cancel.png">\n                            </div>\n                            <div class="content">\n                                <table class="table_search" id ="table_search_comp">\n                                    <tr>\n                                        <th width="200">Клиент</th>\n                                        <th class="cl_com_filters" id="cl_com_product" onclick="clientCompFilter(this)" width="140">\n                                            <div class="flex jc-sb">\n                                                <span>Товар</span>\n                                                <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                                            </div>\n                                        </th>\n                                        <th class="cl_com_filters" id="cl_com_volume" onclick="clientCompFilter(this)" width="100">\n                                            <div class="flex jc-sb">\n                                                <span>Объем</span>\n                                                <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                                            </div>\n                                        </th>\n                                        <th>У кого</th>\n                                        <th class="cl_com_filters" id="cl_com_price" onclick="clientCompFilter(this)" width="100">\n                                            <div class="flex jc-sb">\n                                                <span>Цена</span>\n                                                <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                                            </div>\n                                        </th>\n                                        <th class="cl_com_filters" id="cl_com_manager" onclick="clientCompFilter(this)" width="110">\n                                            <div class="flex jc-sb">\n                                                <span>Менеджер</span>\n                                                <img src="static/images/dropmenu.svg" class="drop_down_img drop_arrow">\n                                            </div>\n                                        </th>\n                                    </tr>\n                                    <tbody id="content_table_comp">\n                                        ${function(e){let t="";competitor_data=[];for(let n=0;n<l.length;n++)for(let a=0;a<r.length;a++)if(l[n].id==r[a].Client_id)for(let i=0;i<e.length;i++)if(e[i].id==l[n].Manager_id||null==l[n].Manager_id){competitor_data.push({id:l[n].id,name:l[n].Name,item:r[a].Name,volume:r[a].Volume,creator:r[a].Creator,cost:r[a].Cost,manager:e[i].second_name}),t+=`\n                                        <tr id="client_${l[n].id}_search" onclick="openCardMenu(this)">\n                                            <td>${l[n].Name}</td>\n                                            <td>${r[a].Name}</td>\n                                            <td>${r[a].Volume}</td>\n                                            <td>${r[a].Creator}</td>\n                                            <td>${r[a].Cost}</td>\n                                            <td>${null==l[n].Manager_id?"Ни к кому не прикреплена":e[i].second_name}</td>\n                                        </tr>\n                                    `;break}return t}(e)}\n                                    </tbody>\n                                </table>\n                            </div>\n                        </div>\n                    `))}})}})}function sortCompTableByPrice(e){competitor_data.sort(function(e,t){return+deleteSpaces(e.cost)>+deleteSpaces(t.cost)?1:+deleteSpaces(e.cost)<+deleteSpaces(t.cost)?-1:0}),"max"==e.id&&competitor_data.reverse(),$("#content_table_comp").empty();let t="";for(let e=0;e<competitor_data.length;e++)t+=`\n            <tr id="client_${competitor_data[e].id}_search" onclick="openCardMenu(this)">\n                <td>${competitor_data[e].name}</td>\n                <td>${competitor_data[e].item}</td>\n                <td>${competitor_data[e].volume}</td>\n                <td>${competitor_data[e].creator}</td>\n                <td>${competitor_data[e].cost}</td>\n                <td>${competitor_data[e].manager}</td>\n            </tr>\n        `;$("#content_table_comp").append(t),setTimeout(function(){$("#cl_com_price .drop_arrow").removeClass("drop_active")},150)}function sortCompTableByProduct(e){$("#content_table_comp").empty();let t="",n=competitor_data.slice();competitor_data=[];for(let r=0;r<n.length;r++)n[r].item==e.innerHTML&&(competitor_data.push(n[r]),t+=`\n                <tr id="client_${n[r].id}_search" onclick="openCardMenu(this)">\n                    <td>${n[r].name}</td>\n                    <td>${n[r].item}</td>\n                    <td>${n[r].volume}</td>\n                    <td>${n[r].creator}</td>\n                    <td>${n[r].cost}</td>\n                    <td>${n[r].manager}</td>\n                </tr>\n            `);$("#content_table_comp").append(t),setTimeout(function(){$("#cl_com_product .drop_arrow").removeClass("drop_active")},150)}function sortCompTableByManagers(e){$("#content_table_comp").empty();let t="",n=competitor_data.slice();competitor_data=[];for(let r=0;r<n.length;r++)n[r].manager==e.innerHTML&&(competitor_data.push(n[r]),t+=`\n                <tr id="client_${n[r].id}_search" onclick="openCardMenu(this)">\n                    <td>${n[r].name}</td>\n                    <td>${n[r].item}</td>\n                    <td>${n[r].volume}</td>\n                    <td>${n[r].creator}</td>\n                    <td>${n[r].cost}</td>\n                    <td>${n[r].manager}</td>\n                </tr>\n            `);$("#content_table_comp").append(t),setTimeout(function(){$("#cl_com_manager .drop_arrow").removeClass("drop_active")},150)}function sortCompTableByVolume(e){competitor_data.sort(function(e,t){return+deleteSpaces(e.volume)>+deleteSpaces(t.volume)?1:+deleteSpaces(e.volume)<+deleteSpaces(t.volume)?-1:0}),"max"==e.id&&competitor_data.reverse(),$("#content_table_comp").empty();let t="";for(let e=0;e<competitor_data.length;e++)t+=`\n            <tr id="client_${competitor_data[e].id}_search" onclick="openCardMenu(this)">\n                <td>${competitor_data[e].name}</td>\n                <td>${competitor_data[e].item}</td>\n                <td>${competitor_data[e].volume}</td>\n                <td>${competitor_data[e].creator}</td>\n                <td>${competitor_data[e].cost}</td>\n                <td>${competitor_data[e].manager}</td>\n            </tr>\n        `;$("#content_table_comp").append(t),setTimeout(function(){$("#cl_com_volume .drop_arrow").removeClass("drop_active")},150)}function clientCompFilter(e){let t=e.id,n=[{id:"cl_com_product",func:function(){let e=$("<ul>",{class:"list"});return $.ajax({url:"/getAllClientItems",type:"GET",dataType:"html",async:!1,success:function(t){t=JSON.parse(t);let n=[];for(let e=0;e<t.length;e++)for(let r=0;r<t[e].data.length;r++)n.push(t[e].data[r]);for(let e=0;e<n.length-1;e++)for(let t=e+1;t<n.length;t++)n[e].Name==n[t].Name&&(n.splice(t,1),t--);for(let t=0;t<n.length;t++)e.append(`\n                        <li onclick="sortCompTableByProduct(this)">${n[t].Name}</li>\n                    `)}}),e}},{id:"cl_com_volume",func:function(){let e=$("<ul>",{class:"list"});return e.append('\n            <li id="min" onclick="sortCompTableByVolume(this)">По возраст.</li>\n            <li id="max" onclick="sortCompTableByVolume(this)">По убыванию</li>\n        '),e}},{id:"cl_com_price",func:function(){let e=$("<ul>",{class:"list"});return e.append('\n            <li id="min" onclick="sortCompTableByPrice(this)">По возраст.</li>\n            <li id="max" onclick="sortCompTableByPrice(this)">По убыванию</li>\n        '),e}},{id:"cl_com_manager",func:function(){let e=$("<ul>",{class:"list"});$.ajax({url:"/getUsers",type:"GET",async:!1,dataType:"html",success:function(e){data_user=JSON.parse(e),$.ajax({url:"/getAllClientItems",type:"GET",dataType:"html",async:!1,success:function(e){data_items=JSON.parse(e)}})}});let t=[];for(let e=0;e<categoryInListClient[1][1].length;e++)for(let n=0;n<data_user.length;n++)for(let r=0;r<data_items.length;r++)for(let a=0;a<data_items[r].data.length;a++)"manager"==data_user[n].role&&categoryInListClient[1][1][e].Manager_id==data_user[n].id&&categoryInListClient[1][1][e].id==data_items[r].data[a].Client_id&&t.push(data_user[n]);for(let e=0;e<t.length-1;e++)for(let n=e+1;n<t.length;n++)t[e].id==t[n].id&&(t.splice(n,1),n--);for(let n=0;n<t.length;n++)e.append($("<li>",{html:t[n].second_name,id:t[n].id,onclick:"sortCompTableByManagers(this)"}));return e}}];function r(){for(let r=0;r<n.length;r++)if(t==n[r].id)return n[r].func(e)}if($(".filter_list").fadeOut(200),setTimeout(function(){$(".filter_list").remove()},200),$(`#${t} .drop_arrow`).hasClass("drop_active"))return $(`#${t} .drop_arrow`).removeClass("drop_active");$(".drop_arrow").removeClass("drop_active"),$(`#${t} .drop_arrow`).addClass("drop_active"),setTimeout(function(){$(e).append($("<div>",{class:"filter_list",css:{top:`${$(e).height()+30}px`},append:r()})),$(".filter_list").fadeIn(100)},250)}let sortStatus={product:{status:!1,filter:null,last:null},price:{status:!1,filter:null},area:{status:!1,filter:null},category:{status:!1,filter:null,last:null},manager:{status:!1,filter:null,last:null},customer:{status:!1,filter:null,last:null},status:{status:!1,filter:null,last:null},date:{status:!1,filter:null,last:null},search_on_regions:{status:!1,filter:null,last:null}};function sortTableByCategory(e){let t,n=e.innerHTML,r=[];sortStatus.manager.status||sortStatus.area.status?t=null==filterClient[1][1]?categoryInListClient[1][1]:null==sortStatus.category.last?filterClient[1][1]:sortStatus.category.last:(null!=filterClient[1][1]&&filterClient[1].pop(),t=categoryInListClient[1][1]);for(let e=0;e<t.length;e++)t[e].Category===n&&r.push(t[e]);null!=filterClient[1][1]&&filterClient[1].pop(),filterClient[1][1]=r,$(".table").remove(),$(".info").append(fillingTables(filterClient)),sortStatus.category.status=!0,sortStatus.category.filter=n,$(".centerBlock .header .cancel").remove(),$(".centerBlock .header").append('\n        <div class="cancel">\n            <button class="btn btn-main" onclick="cancelSearch()">Отменить поиск</button>\n        </div>\n    '),setTimeout(function(){$("#cl_category .drop_arrow").removeClass("drop_active")},150)}function sortTableByStatus(e){let t=$(e).html();if("delivery"==saveTableAndCard[0].id||"filter_delivery"==saveTableAndCard[0].id){let n;sortStatus.customer.status||sortStatus.date.status?n=null==filterDelivery[1][1]?categoryInDelivery[1][1]:null==sortStatus.status.last?filterDelivery[1][1]:sortStatus.status.last:(null!=filterDelivery[1][1]&&filterDelivery[1].pop(),n=categoryInDelivery[1][1]);let r=[];for(let t=0;t<n.length;t++){let a=null==JSON.parse(n[t].delivery.Payment_list)?[{price:0}]:JSON.parse(n[t].delivery.Payment_list),l=null==JSON.parse(n[t].delivery.Amounts)?[{sum:0}]:JSON.parse(n[t].delivery.Amounts),i=0,s=0;for(let e=0;e<a.length;e++)i+=+deleteSpaces(a[e].price);for(let e=0;e<l.length;e++)s+=+deleteSpaces(l[e].sum);1==e.id&&s==i&&r.push(n[t]),2==e.id&&s!=i&&r.push(n[t])}filterDelivery[1][1]=r,$(".table").remove(),$(".info").append(fillingTables(filterDelivery)),sortStatus.status.status=!0,sortStatus.status.filter=t,$(".centerBlock .header .cancel").remove(),$(".centerBlock .header").append('\n            <div class="cancel">\n                <button class="btn btn-main" onclick="cancelSearch()">Отменить поиск</button>\n            </div>\n        '),setTimeout(function(){$("#dl_status .drop_arrow").removeClass("drop_active")},150)}}function sortTableByDate(e){let t=$(e).html();if("delivery"==saveTableAndCard[0].id||"filter_delivery"==saveTableAndCard[0].id){let n;sortStatus.customer.status||sortStatus.status.status?n=null==filterDelivery[1][1]?categoryInDelivery[1][1]:null==sortStatus.date.last?filterDelivery[1][1]:sortStatus.date.last:(null!=filterDelivery[1][1]&&filterDelivery[1].pop(),n=categoryInDelivery[1][1]);let r=[];for(let t=0;t<n.length;t++)"true"==e.id&&""!=n[t].delivery.Payment_date&&r.push(n[t]),"false"==e.id&&""==n[t].delivery.Payment_date&&r.push(n[t]);filterDelivery[1][1]=r,$(".table").remove(),$(".info").append(fillingTables(filterDelivery)),sortStatus.date.status=!0,sortStatus.date.filter=t,$(".centerBlock .header .cancel").remove(),$(".centerBlock .header").append('\n            <div class="cancel">\n                <button class="btn btn-main" onclick="cancelSearch()">Отменить поиск</button>\n            </div>\n        '),setTimeout(function(){$("#dl_date .drop_arrow").removeClass("drop_active")},150)}}function sortTableByCustomer(e){let t=$(e).html();if("delivery"==saveTableAndCard[0].id||"filter_delivery"==saveTableAndCard[0].id){let e;sortStatus.date.status||sortStatus.status.status?e=null==filterDelivery[1][1]?categoryInDelivery[1][1]:null==sortStatus.customer.last?filterDelivery[1][1]:sortStatus.customer.last:(null!=filterDelivery[1][1]&&filterDelivery[1].pop(),e=categoryInDelivery[1][1]);let n=[];for(let r=0;r<e.length;r++)e[r].delivery.Customer==t&&n.push(e[r]);filterDelivery[1][1]=n,$(".table").remove(),$(".info").append(fillingTables(filterDelivery)),sortStatus.customer.status=!0,sortStatus.customer.filter=t,$(".centerBlock .header .cancel").remove(),$(".centerBlock .header").append('\n            <div class="cancel">\n                <button class="btn btn-main" onclick="cancelSearch()">Отменить поиск</button>\n            </div>\n        '),setTimeout(function(){$("#dl_customer .drop_arrow").removeClass("drop_active")},150)}}function sortTableByManagers(e){let t,n=e.innerHTML;$(".centerBlock .header .cancel").remove(),$.ajax({url:"/getUsers",type:"GET",async:!1,dataType:"html",success:function(e){t=JSON.parse(e)}});for(let e=0;e<t.length;e++)if("manager"==t[e].role&&t[e].second_name==n){let r,a=t[e].id;"client"==saveTableAndCard[0].id?(sortStatus.category.status||sortStatus.area.status?r=null==filterClient[1][1]?categoryInListClient[1][1]:null==sortStatus.manager.last?filterClient[1][1]:sortStatus.manager.last:(null!=filterClient[1][1]&&filterClient[1].pop(),r=categoryInListClient[1][1]),sortStatus.manager.last=categoryInListClient[1][1]):r=saveTableAndCard[1][1];let l=[{id:"client",list:"Manager_id",filter:filterClient},{id:"provider",list:"Manager_id",filter:filterProvider},{id:"carrier",list:"Manager_id",filter:filterCarrier}],i=[];for(let e=0;e<l.length;e++)if(l[e].id==saveTableAndCard[0].id){for(let t=0;t<r.length;t++){r[t][l[e].list]==a&&i.push(r[t])}let t=[];for(let e=0;e<i.length;e++)"Клиент"===i[e].Category&&(t.push(i[e]),i.splice(e,1),e--);for(let e=0;e<t.length;e++)i.push(t[e]);l[e].filter[1][1]=i.reverse(),$(".table").remove(),$(".info").append(fillingTables(l[e].filter));break}"client"==saveTableAndCard[0].id&&(sortStatus.manager.status=!0,sortStatus.manager.filter=n),$(".centerBlock .header .cancel").remove(),$(".centerBlock .header").append('\n                <div class="cancel">\n                    <button class="btn btn-main" onclick="cancelSearch()">Отменить поиск</button>\n                </div>\n            '),setTimeout(function(){$("#pd_manager .drop_arrow").removeClass("drop_active")},150);break}}function sortTableByArea(e,t=!0){let n;"client"==saveTableAndCard[0].id?sortStatus.manager.status||sortStatus.category.status||sortStatus.search_on_regions.status?n=filterClient:(null!=filterClient[1][1]&&filterClient[1].pop(),n=categoryInListClient.slice()):n=saveTableAndCard.slice();let r=[],a=null==e.id?e:e.id;for(let e=0;e<n[1][1].length;e++){let t=[n[1][1][e]];for(let r=e+1;r<n[1][1].length;r++)n[1][1][e].Oblast===n[1][1][r].Oblast&&(t.push(n[1][1][r]),n[1][1].splice(r,1),r--);t.sort(function(e,t){if(null!=e.Rayon)if("min"==a)if("provider"==n[0].id){if(e.Rayon<t.Rayon)return 1;if(e.Rayon>t.Rayon)return-1}else{if(e.Rayon>t.Rayon)return 1;if(e.Rayon<t.Rayon)return-1}else if("provider"==n[0].id){if(e.Rayon>t.Rayon)return 1;if(e.Rayon<t.Rayon)return-1}else{if(e.Rayon<t.Rayon)return 1;if(e.Rayon>t.Rayon)return-1}else if("min"==a){if(e.Area>t.Area)return 1;if(e.Area<t.Area)return-1}else{if(e.Area<t.Area)return 1;if(e.Area>t.Area)return-1}return 0});for(let e=0;e<t.length;e++)r.push(t[e])}r.sort(function(e,t){if(null!=e.Oblast)if("provider"==n[0].id){if(e.Oblast<t.Oblast)return 1;if(e.Oblast>t.Oblast)return-1}else{if(e.Oblast>t.Oblast)return 1;if(e.Oblast<t.Oblast)return-1}else{if(e.Region>t.Region)return 1;if(e.Region<t.Region)return-1}return 0});let l=[];for(let e=0;e<r.length;e++)"Клиент"===r[e].Category&&(l.push(r[e]),r.splice(e,1),e--);for(let e=0;e<l.length;e++)r.unshift(l[e]);null!=n[1][1]&&n[1].pop(),n[1].push(r),$(".table").remove(),$(".info").append(fillingTables(n,!0)),"client"==saveTableAndCard[0].id&&(sortStatus.area.status=!0,sortStatus.area.filter=a),$(".centerBlock .header .cancel").remove(),t&&$(".centerBlock .header").append('\n            <div class="cancel">\n                <button class="btn btn-main" onclick="cancelSearch()">Отменить поиск</button>\n            </div>\n        '),setTimeout(function(){$("#all_area .drop_arrow").removeClass("drop_active")},150)}function sortTableByPrice(e){let t;sortStatus.product.status?t=filterProvider[1][1]:(null!=filterProvider[1][1]&&filterProvider[1].pop(),t=categoryInListProvider[1][1]);let n=[];for(let e=0;e<t.length;e++){let r="string"==typeof t[e].Item_list?JSON.parse(t[e].Item_list):[];for(let a=0;a<r.length;a++)n.push({id:t[e].id,product:r[a].item_product,price:+deleteSpaces(r[a].item_price)})}let r=[];for(let e=0;e<t.length;e++){let a="string"==typeof t[e].Item_list?JSON.parse(t[e].Item_list):[];for(let l=0;l<a.length;l++)for(let i=0;i<n.length;i++)n[i].id==t[e].id&&n[i].product==a[l].item_product&&n[i].price==+deleteSpaces(a[l].item_price)&&"Выбрать"!=n[i].product&&"Выбрать"!=a[l].item_product&&""!=a[l].item_price&&r.push({Oblast:t[e].Oblast,Rayon:t[e].Rayon,Name:t[e].Name,Item_list:JSON.stringify([{item_product:a[l].item_product,item_price:a[l].item_price}]),Manager_id:t[e].Manager_id,id:t[e].id,Manager_active:!0})}r.sort(function(e,t){return+deleteSpaces(JSON.parse(e.Item_list)[0].item_price)>+deleteSpaces(JSON.parse(t.Item_list)[0].item_price)?1:+deleteSpaces(JSON.parse(e.Item_list)[0].item_price)<+deleteSpaces(JSON.parse(t.Item_list)[0].item_price)?-1:0}),"min"==e.id&&r.reverse(),null!=filterProvider[1][1]&&filterProvider[1].pop(),filterProvider[1].push(r),$(".table").remove(),$(".info").append(fillingTables(filterProvider,!0)),sortStatus.price.status=!0,sortStatus.price.filter=e.id,$(".centerBlock .header .cancel").remove(),$(".centerBlock .header").append('\n        <div class="cancel">\n            <button class="btn btn-main" onclick="cancelSearch()">Отменить поиск</button>\n        </div>\n    '),setTimeout(function(){$("#pd_price .drop_arrow").removeClass("drop_active")},150)}function sortTableByProduct(e){let t;sortStatus.price.status?t=null==sortStatus.product.last?filterProvider[1][1]:sortStatus.product.last:(null!=filterProvider[1][1]&&filterProvider[1].pop(),t=categoryInListProvider[1][1]),sortStatus.product.last=categoryInListProvider[1][1];let n=[];for(let e=0;e<t.length;e++){let r="string"==typeof t[e].Item_list?JSON.parse(t[e].Item_list):[];for(let a=0;a<r.length;a++)n.push({id:t[e].id,product:r[a].item_product,price:+r[a].item_price})}let r=[];for(let a=0;a<t.length;a++){let l="string"==typeof t[a].Item_list?JSON.parse(t[a].Item_list):[];for(let i=0;i<l.length;i++)for(let s=0;s<n.length;s++)n[s].id==t[a].id&&n[s].product==l[i].item_product&&n[s].price==l[i].item_price&&e.innerHTML==l[i].item_product&&r.push({Oblast:t[a].Oblast,Rayon:t[a].Rayon,Name:t[a].Name,Item_list:JSON.stringify([{item_product:l[i].item_product,item_price:l[i].item_price}]),Manager_id:t[a].Manager_id,id:t[a].id,Manager_active:!0})}null!=filterProvider[1][1]&&filterProvider[1].pop(),filterProvider[1].push(r),$(".table").remove(),$(".info").append(fillingTables(filterProvider,!0)),sortStatus.product.status=!0,sortStatus.product.filter=e.innerHTML,$(".centerBlock .header .cancel").remove(),$(".centerBlock .header").append('\n        <div class="cancel">\n            <button class="btn btn-main" onclick="cancelSearch()">Отменить поиск</button>\n        </div>\n    '),setTimeout(function(){$("#pd_group .drop_arrow").removeClass("drop_active")},150)}function selectFilterDate(e){let t=e.id;function n(){let e=$("<ul>",{class:"list"});return e.append('\n            <li id="true" onclick="sortTableByDate(this)">Указана</li>\n            <li id="false" onclick="sortTableByDate(this)">Не указана</li>\n        '),e}if($(".filter_list").fadeOut(200),setTimeout(function(){$(".filter_list").remove()},200),$(`#${t} .drop_arrow`).hasClass("drop_active"))return $(`#${t} .drop_arrow`).removeClass("drop_active");$(".drop_arrow").removeClass("drop_active"),$(`#${t} .drop_arrow`).addClass("drop_active"),setTimeout(function(){$(e).append($("<div>",{class:"filter_list",css:{top:`${$(e).height()+30}px`},append:n()})),$(".filter_list").fadeIn(100)},250)}function selectFilterStatus(e){let t=e.id;function n(){let e=$("<ul>",{class:"list"}),t=["Оплачено","Не оплачено"];for(let n=0;n<t.length;n++)e.append(`\n                <li id="${n+1}" onclick="sortTableByStatus(this)">${t[n]}</li>\n            `);return e}if($(".filter_list").fadeOut(200),setTimeout(function(){$(".filter_list").remove()},200),$(`#${t} .drop_arrow`).hasClass("drop_active"))return $(`#${t} .drop_arrow`).removeClass("drop_active");$(".drop_arrow").removeClass("drop_active"),$(`#${t} .drop_arrow`).addClass("drop_active"),setTimeout(function(){$(e).append($("<div>",{class:"filter_list",css:{top:`${$(e).height()+30}px`},append:n()})),$(".filter_list").fadeIn(100)},250)}function selectFilterCustomer(e){let t=e.id;function n(){let e=$("<ul>",{class:"list"}),t=["ООО","ИП"];for(let n=0;n<t.length;n++)e.append(`\n                <li onclick="sortTableByCustomer(this)">${t[n]}</li>\n            `);return e}if($(".filter_list").fadeOut(200),setTimeout(function(){$(".filter_list").remove()},200),$(`#${t} .drop_arrow`).hasClass("drop_active"))return $(`#${t} .drop_arrow`).removeClass("drop_active");$(".drop_arrow").removeClass("drop_active"),$(`#${t} .drop_arrow`).addClass("drop_active"),setTimeout(function(){$(e).append($("<div>",{class:"filter_list",css:{top:`${$(e).height()+30}px`},append:n()})),$(".filter_list").fadeIn(100)},250)}function selectFilterCategory(e){let t=e.id;function n(){let e=$("<ul>",{class:"list"}),t=saveTableAndCard[1][1],n=[];for(let e=0;e<t.length;e++)null!=t[e].Category&&""!=t[e].Category&&n.push(t[e].Category);for(let e=0;e<n.length-1;e++)for(let t=e+1;t<n.length;t++)n[e]==n[t]&&(n.splice(t,1),t--);for(let t=0;t<n.length;t++)e.append(`\n                <li onclick="sortTableByCategory(this)">${n[t]}</li>\n            `);return e}if($(".filter_list").fadeOut(200),setTimeout(function(){$(".filter_list").remove()},200),$(`#${t} .drop_arrow`).hasClass("drop_active"))return $(`#${t} .drop_arrow`).removeClass("drop_active");$(".drop_arrow").removeClass("drop_active"),$(`#${t} .drop_arrow`).addClass("drop_active"),setTimeout(function(){$(e).append($("<div>",{class:"filter_list",css:{top:`${$(e).height()+30}px`},append:n()})),$(".filter_list").fadeIn(100)},250)}function selectFilterArea(e){let t=e.id;function n(){let e=$("<ul>",{class:"list"});return e.append('\n            <li id="min" onclick="sortTableByArea(this)">От А до Я</li>\n            <li id="max" onclick="sortTableByArea(this)">От Я до А</li>\n        '),e}if($(".filter_list").fadeOut(200),setTimeout(function(){$(".filter_list").remove()},200),$(`#${t} .drop_arrow`).hasClass("drop_active"))return $(`#${t} .drop_arrow`).removeClass("drop_active");$(".drop_arrow").removeClass("drop_active"),$(`#${t} .drop_arrow`).addClass("drop_active"),setTimeout(function(){$(e).append($("<div>",{class:"filter_list",css:{top:`${$(e).height()+30}px`},append:n()})),$(".filter_list").fadeIn(100)},250)}function selectFilterPrice(e){let t=e.id;function n(){let e=$("<ul>",{class:"list"});return e.append('\n            <li id="min" onclick="sortTableByPrice(this)">По возраст.</li>\n            <li id="max" onclick="sortTableByPrice(this)">По убыванию</li>\n        '),e}if($(".filter_list").fadeOut(200),setTimeout(function(){$(".filter_list").remove()},200),$(`#${t} .drop_arrow`).hasClass("drop_active"))return $(`#${t} .drop_arrow`).removeClass("drop_active");$(".drop_arrow").removeClass("drop_active"),$(`#${t} .drop_arrow`).addClass("drop_active"),setTimeout(function(){$(e).append($("<div>",{class:"filter_list",css:{top:`${$(e).height()+30}px`},append:n()})),$(".filter_list").fadeIn(100)},250)}function selectGroupProduct(e){let t=e.id;function n(){let e=$("<ul>",{class:"list"}),t=categoryInListProvider[1][1],n=[];for(let e=0;e<t.length;e++){let r="string"==typeof t[e].Item_list?JSON.parse(t[e].Item_list):[];if(r.length>0)for(let e=0;e<r.length;e++)n.push(r[e].item_product)}for(let e=0;e<n.length-1;e++)for(let t=e+1;t<n.length;t++)n[e]==n[t]&&(n.splice(t,1),t--);for(let t=0;t<n.length;t++)e.append(`\n                <li onclick="sortTableByProduct(this)">${n[t]}</li>\n            `);return e}if($(".filter_list").fadeOut(200),setTimeout(function(){$(".filter_list").remove()},200),$(`#${t} .drop_arrow`).hasClass("drop_active"))return $(`#${t} .drop_arrow`).removeClass("drop_active");$(".drop_arrow").removeClass("drop_active"),$(`#${t} .drop_arrow`).addClass("drop_active"),setTimeout(function(){$(e).append($("<div>",{class:"filter_list",css:{top:`${$(e).height()+30}px`},append:n()})),$(".filter_list").fadeIn(100)},250)}function selectManager(e){let t=e.id;function n(){let e=$("<ul>",{class:"list"});$.ajax({url:"/getUsers",type:"GET",async:!1,dataType:"html",success:function(e){data=JSON.parse(e)}});let t=[];for(let e=0;e<saveTableAndCard[1][1].length;e++)for(let n=0;n<data.length;n++)"manager"==data[n].role&&saveTableAndCard[1][1][e].Manager_id==data[n].id&&t.push(data[n]);for(let e=0;e<t.length-1;e++)for(let n=e+1;n<t.length;n++)t[e].id==t[n].id&&(t.splice(n,1),n--);for(let n=0;n<t.length;n++)e.append($("<li>",{html:t[n].second_name,id:t[n].id,onclick:"sortTableByManagers(this)"}));return e}if($(".filter_list").fadeOut(200),setTimeout(function(){$(".filter_list").remove()},200),$(`#${t} .drop_arrow`).hasClass("drop_active"))return $(`#${t} .drop_arrow`).removeClass("drop_active");$(".drop_arrow").removeClass("drop_active"),$(`#${t} .drop_arrow`).addClass("drop_active"),setTimeout(function(){$(e).append($("<div>",{class:"filter_list",css:{top:`${$(e).height()+30}px`},append:n()})),$(".filter_list").fadeIn(100)},250)}function fillingTables(e,t=!1){"filter_stock"!==e[0].id&&(e[0].active=!0,t||(saveTableAndCard=e));for(let t=e[0].lastCard.length-1;t>=0;t--)if(null!=e[0].lastCard[t])return e[0].lastCard[t];if("analytics"===e[0].id){let e=datePeriod("month");if("admin"==user.role)return analyticsFilterTable_0(e);if("manager"==user.role)return analyticsFilterTable_1(e)}let n=$("<table />",{class:"table",id:e[0].id});return rowFilling(e[e.length-1],e[0].id,n)}